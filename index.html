<head>
</head>
<body>
	<h2>Threat Model My App</h2>
	<p>Which of the following are present in the new release of your web application?</p>
	<form id="form" action="#">
		<input type="checkbox" id="authentication">
  		<label> User authentication</label><br>
  		<input type="checkbox" id="input">
  		<label> User input</label><br>
  		<input type="checkbox" id="xml">
  		<label> XML processor</label><br>
  		<input type="checkbox" id="file">
  		<label> File upload</label><br>
  		<br>
		<input type="submit" value="Submit">
	</form>
	<div id="results">
	</div>
	<script>
		document.getElementById("form").onsubmit = function() {renderThreatModel()};
		function renderThreatModel() {
			var resultsText = "Man-in-the-middle attack (TLS 1.2, HSTS Header, disable weak ciphers\nSecurity misconfiguration (Content Security Policy, X-Frame-Options, X-Content-Type-Options, HSTS)\nDenial of service (WAF)\nSensitive data exposure\nUse of hard-coded password\nVulnerable open-source libraries\nBroken cryptographic algorithm\nError handling\nCookie without secure attribute\n";
			if (document.getElementById("xml").checked == true) {
				resultsText += "XXE\n";
			}
			if (document.getElementById("authentication").checked == true) {
				resultsText += "Broken authentication (Password complexity, password reuse policy, common password dictionary, account lockout, application logging and monitoring, forgot password, secure session management)\nInsufficient entropy\nSession fixation\nPasswords compromised\nCSRF\nBroken access control\n"
			}
			if (document.getElementById("input").checked == true) {
				resultsText += "SQL injection\nXSS\nCLRF/HTTP response splitting/improper output neutralization for logs\nOpen redirect\nInsecure deserialization\nSSRF\nExternal control of file name or path\n"
			}
			if (document.getElementById("file").checked == true) {
				resultsText += "Malicious file upload"
			}
			document.getElementById("results").innerText = resultsText;
		}
	</script>
</body>